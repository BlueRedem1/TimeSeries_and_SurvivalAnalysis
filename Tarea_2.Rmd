---
title: "Tarea 2 Propiedades de los modelos ARMA"
author: "Cuéllar, Eduardo, García Jesús, Miranda Areli, Ramirez José, Saldaña Ricardo "
date: "10/26/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
1.- Considere el proceso $MA(2)$:

$$ X_t = Z_t - 0.4Z_{t-1} - 1.2Z_{t-2} $$
donde ${Z_{t}}$ es un ruido blanco Gaussiano.

(a) Calcule $\sigma^{2}_{X}$ suponiendo que $\sigma^{2}_{Z}$ = 1.
(b) Encuentre la expresión general para la función de autocorrelación $\rho_{k}$.
(c) Grafique $\rho_{k}$ (correlograma ACF), para $k= 0,1,2,...,10$.
(d) Encuentre la expresión general para la funció de autocorrelación parcial $\phi_{kk}$.
(e) Grafique $\phi_{kk}$ (correlograma PACF), para $k = 0,1,2,...,10$.
(f) En R simule el proceso ${X_{t}}$ para un tamaño de muestra $n$, grafique la serie de tiempo y los correlogramas ACF y PACF.
Compare los correlogramas simulados con los del proceso original.

Respueta: 

a) $Var$($X_{t}$) = $Var(Z_{t} - 0.4_{t-1}, - 1.2Z_{t-2})$ .... (1)
Como $Z_{k}$ $\perp$ $Z_{j}$ $\forall$ $k \ne j$

Podemos expresar a (1) de la siguiente manera:

$$ = Var(Z_{t}) + Var(-0.4 Z_{t-1}) + Var(-1.2Z_{t-2}) $$
$$ =  Var(Z_{t}) + (-0.4)^{2} Var(Z_{t-1}) + (-1.2)^{2} Var(Z_{t-2}) .... (2)$$
Como $Z_{t}$ son $v.a.i.i.d.$, con $E[Z_{t}] = 0$ y $Var(Z_{t}) = 1$

$$ (2) = 1 + (.16)(1) + (1.44)(1)==
$$ = 1 + .16 + 1.44 $$
$$ = 2.6  Cov(Z_{t} - 1.4Z_{t-1} - 1.2Z_{t-2}, Z_{t+k} - 0.4Z_{t-1+k} - Z_{t-2+k}) $$





Automatizaremos la obtención de los coeficientes del PACF para el ejercicio 1:
```{r}
#x será el vector con los coeficientes de autocorrelación
coefs_pacf<-function(p,k){
  if(length(p)<k+1){
    for(i in length(p):k){
      p[i+1]=0
    }
  }
  A<-matrix(nrow=k,ncol = k)
  for (j in 1:k){
    for (i in 1:k){
       A[i,j]=p[abs(i-j)+1]
    }
  }
  B<-A
  for (i in 1:k){
    B[i,k]=p[i+1]
  }
  return(det(B)/det(A))
}
```

Aquí deben ir los coeficientes de $\rho$_k distintos de 0
```{r}
#cambiar a los que tengo en el pdf, estos son de prueba
x=c(1,-180/269,50/269)
for (i in 1:10){
  print(coefs_pacf(x,i))
}
```



