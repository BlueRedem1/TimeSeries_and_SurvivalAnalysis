% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Tarea 2 Propiedades de los modelos ARMA},
  pdfauthor={Cuéllar, Eduardo, García Jesús, Miranda Areli, Ramirez José, Saldaña Ricardo},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Tarea 2 Propiedades de los modelos ARMA}
\author{Cuéllar, Eduardo, García Jesús, Miranda Areli, Ramirez José,
Saldaña Ricardo}
\date{10/26/2021}

\begin{document}
\maketitle

1.- Considere el proceso \(MA(2)\):

\[ X_t = Z_t - 0.4Z_{t-1} - 1.2Z_{t-2} \] donde \({Z_{t}}\) es un ruido
blanco Gaussiano.

\begin{enumerate}
\def\labelenumi{(\alph{enumi})}
\tightlist
\item
  Calcule \(\sigma^{2}_{X}\) suponiendo que \(\sigma^{2}_{Z}\) = 1.
\item
  Encuentre la expresión general para la función de autocorrelación
  \(\rho_{k}\).
\item
  Grafique \(\rho_{k}\) (correlograma ACF), para \(k= 0,1,2,...,10\).
\item
  Encuentre la expresión general para la funció de autocorrelación
  parcial \(\phi_{kk}\).
\item
  Grafique \(\phi_{kk}\) (correlograma PACF), para \(k = 0,1,2,...,10\).
\item
  En R simule el proceso \({X_{t}}\) para un tamaño de muestra \(n\),
  grafique la serie de tiempo y los correlogramas ACF y PACF. Compare
  los correlogramas simulados con los del proceso original.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Cargamos librerías}
\FunctionTok{library}\NormalTok{(ggplot2);}\FunctionTok{library}\NormalTok{(itsmr);}\FunctionTok{library}\NormalTok{(forecast);}\FunctionTok{library}\NormalTok{(TSA);}\FunctionTok{library}\NormalTok{(lmtest)}
\FunctionTok{library}\NormalTok{(timeSeries);}\FunctionTok{library}\NormalTok{(timeSeries);}\FunctionTok{library}\NormalTok{(astsa);}
\FunctionTok{library}\NormalTok{(tseries);}\FunctionTok{library}\NormalTok{(forecast);}\FunctionTok{library}\NormalTok{(nortest)}
\end{Highlighting}
\end{Shaded}

Respueta:

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\tightlist
\item
  \(Var\)(\(X_{t}\)) = \(Var(Z_{t} - 0.4_{t-1}, - 1.2Z_{t-2})\)
  \(\dots\) (1)
\end{enumerate}

Como \(Z_{k}\) \(\perp\) \(Z_{j}\) \(\forall\) \(k \ne j\), podemos
expresar a (1) de la siguiente manera:

\[ 
\begin{aligned} &= Var(Z_{t}) + Var(-0.4 Z_{t-1}) + Var(-1.2Z_{t-2})\\ 
                &=  Var(Z_{t}) + (-0.4)^{2} Var(Z_{t-1}) + (-1.2)^{2} Var(Z_{t-2}) \dots (2)
\end{aligned}
\] Como \(Z_{t}\) son \(v.a.i.i.d.\), con \(\mathbb{E}[Z_{t}] = 0\) y
\(Var(Z_{t}) = 1\)

\[ 
\begin{aligned}(2) &= 1 + (.16)(1) + (1.44)(1)\\
                   &= 1 + .16 + 1.44\\ 
                   &= 2.6  Cov(Z_{t} - 1.4Z_{t-1} - 1.2Z_{t-2}, Z_{t+k} - 0.4Z_{t-1+k} - Z_{t-2+k}) 
\end{aligned}
\]

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Veamos la autocovarianza:
\end{enumerate}

\[ 
\begin{aligned} \gamma(k) &= Cov(X_{t}, X_{t+k})\\ 
                          &= Cov(Z_{t} - 0.4Z_{t-1} - 1.2Z_{t-2}, Z_{t+k} - 0.4Z_{t-1+k} - 1.2Z_{t-2+k})\\
                          &= Cov(Z_{t}, Z{_t+k}) - 0.4 Cov(Z_{t}, Z_{t+k-1}) - 1.2 Cov(Z_{t}, Z_{t+k-2})\\
                          &-0.4 Cov(Z_{t-1},Z_{t+k}) + .16Cov(Z_{t-1},Z_{t+k-1}) + .48Cov(Z_{t-1}, Z_{t+k-2})\\
                          &-1.2Cov(Z_{t-2}, Z_{t+k}) + .48 Cov(Z_{t-2}, Z_{t+k_1}) + 1.44 Cov(Z_{t-2}, Z_{t+k-2})
\end{aligned}
\]

Si \(k = 0\), entonces:

\$\$

\begin{aligned} \gamma(0) &= Cov(Z_{t}, Z_{t}) + .16 Cov(Z_{t-1}, Z_{t+k-1}) + 1.44 Cov(Z_{t-2}, Z_{t+k-2})\\
                          &= Var(Z_{t}) + .16Var(Z_{t}) + 1.44 Var(Z_{t})\\ 
                          &= 2.6\\
                          &= Var(X_{t}).

\end{aligned}

\$\$

Y 0 en los demás, ya que \(Z_{j}\) \(\forall\) \(k \ne j\)

Gráfica:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acf\_coefs\_ej1}\OtherTok{=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\SpecialCharTok{/}\DecValTok{65}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{6}\SpecialCharTok{/}\DecValTok{13}\NormalTok{)}
\CommentTok{\#llenemos de 0 los faltantes}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ (}\FunctionTok{length}\NormalTok{(acf\_coefs\_ej1)}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\DecValTok{11}\NormalTok{)\{}
\NormalTok{  acf\_coefs\_ej1[i]}\OtherTok{=}\DecValTok{0}
\NormalTok{\}}
\NormalTok{ACF\_1}\OtherTok{\textless{}{-}}\FunctionTok{data.frame}\NormalTok{(}\StringTok{\textquotesingle{}ACF\textquotesingle{}}\OtherTok{=}\NormalTok{acf\_coefs\_ej1,}\AttributeTok{lag=}\DecValTok{0}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}
\NormalTok{ACF\_1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            ACF lag
## 1   1.00000000   0
## 2   0.03076923   1
## 3  -0.46153846   2
## 4   0.00000000   3
## 5   0.00000000   4
## 6   0.00000000   5
## 7   0.00000000   6
## 8   0.00000000   7
## 9   0.00000000   8
## 10  0.00000000   9
## 11  0.00000000  10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(ACF\_1,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{lag,}\AttributeTok{y=}\NormalTok{ACF))}\SpecialCharTok{+}\FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}\FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =} \DecValTok{0}\NormalTok{,}\AttributeTok{slope=}\DecValTok{0}\NormalTok{,}\AttributeTok{color=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-2-1.pdf}

Automatizaremos la obtención de los coeficientes del PACF para el
ejercicio 1:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#x será el vector con los coeficientes de autocorrelación}
\NormalTok{coefs\_pacf}\OtherTok{\textless{}{-}}\ControlFlowTok{function}\NormalTok{(p,k)\{}
  \ControlFlowTok{if}\NormalTok{(k}\SpecialCharTok{==}\DecValTok{0}\NormalTok{)\{}
    \FunctionTok{return}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{  \}}
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(p)}\SpecialCharTok{\textless{}}\NormalTok{k}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)\{}
    \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \FunctionTok{length}\NormalTok{(p)}\SpecialCharTok{:}\NormalTok{k)\{}
\NormalTok{      p[i}\SpecialCharTok{+}\DecValTok{1}\NormalTok{]}\OtherTok{=}\DecValTok{0}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{  A}\OtherTok{\textless{}{-}}\FunctionTok{matrix}\NormalTok{(}\AttributeTok{nrow=}\NormalTok{k,}\AttributeTok{ncol =}\NormalTok{ k)}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{k)\{}
    \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{k)\{}
\NormalTok{       A[i,j]}\OtherTok{=}\NormalTok{p[}\FunctionTok{abs}\NormalTok{(i}\SpecialCharTok{{-}}\NormalTok{j)}\SpecialCharTok{+}\DecValTok{1}\NormalTok{]}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{  B}\OtherTok{\textless{}{-}}\NormalTok{A}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{k)\{}
\NormalTok{    B[i,k]}\OtherTok{=}\NormalTok{p[i}\SpecialCharTok{+}\DecValTok{1}\NormalTok{]}
\NormalTok{  \}}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{det}\NormalTok{(B)}\SpecialCharTok{/}\FunctionTok{det}\NormalTok{(A))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

¿Cómo funciona? Bien, en clase, en la página 27 de las notas, podemos
observar que \(\phi_{kk}\), que es el coeficiente de autocorrelación
parcial para un lag de \(k\) se puede calcular usando Cramer. Observamos
el patrón de que en la matriz que `va en el denominador', iba el
coeficiente \(\rho_{i}\) donde \(i\) era el valor absoluto de la
diferencia entre el número de columna y renglón, por ello es que
llenamos la matriz como \(A[i,j]=p[abs(i-j)+1]\). En la matriz
`numerador', únicamente es cambiar el último renglón por los \(\rho_j\)
donde \(j\) es el número de renglón, siendo ambas matrices de dimensión
\(k*k\)

Ahora solo aplicamos la fórmula:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pacf\_ej1}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{11}\NormalTok{)\{}
\NormalTok{  pacf\_ej1[i]}\OtherTok{\textless{}{-}}\FunctionTok{coefs\_pacf}\NormalTok{(acf\_coefs\_ej1,i}\DecValTok{{-}1}\NormalTok{)}
\NormalTok{\}}
\NormalTok{PACF\_1}\OtherTok{=}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{PACF=}\NormalTok{pacf\_ej1,}\AttributeTok{lag=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{10}\NormalTok{))}
\NormalTok{PACF\_1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           PACF lag
## 1   1.00000000   0
## 2   0.03076923   1
## 3  -0.46292348   2
## 4   0.04461263   3
## 5  -0.27566723   4
## 6   0.05170474   5
## 7  -0.18101857   6
## 8   0.05318550   7
## 9  -0.12591880   8
## 10  0.05090694   9
## 11 -0.09137468  10
\end{verbatim}

Graficamos

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(PACF\_1,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{lag,}\AttributeTok{y=}\NormalTok{PACF))}\SpecialCharTok{+}\FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}\FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =} \DecValTok{0}\NormalTok{,}\AttributeTok{slope=}\DecValTok{0}\NormalTok{,}\AttributeTok{color=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-5-1.pdf}

Simulamos

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\NormalTok{MA2}\OtherTok{=}\FunctionTok{arima.sim}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\AttributeTok{order=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{2}\NormalTok{), }\AttributeTok{ma=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{1.2}\NormalTok{)),}\AttributeTok{n=}\DecValTok{500}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(MA2, }\AttributeTok{main=}\StringTok{"Simulación MA(2)"}\NormalTok{, }\AttributeTok{col=}\StringTok{"purple"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{""}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{, }\AttributeTok{xlab=}\StringTok{"Tiempo"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#Vamos a calcular el ACF de manera teorica }
\NormalTok{(}\AttributeTok{ACFMA=}\FunctionTok{ARMAacf}\NormalTok{( }\AttributeTok{ma=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{1.2}\NormalTok{), }\AttributeTok{ar=}\DecValTok{0}\NormalTok{,}\DecValTok{15}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           0           1           2           3           4           5 
##  1.00000000  0.03076923 -0.46153846  0.00000000  0.00000000  0.00000000 
##           6           7           8           9          10          11 
##  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 
##          12          13          14          15 
##  0.00000000  0.00000000  0.00000000  0.00000000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(ACFMA[}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{],}\AttributeTok{type=}\StringTok{"h"}\NormalTok{, }\AttributeTok{main=}\StringTok{"ACF teorico de un MA(2)"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{las=}\DecValTok{1}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{0}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{col=}\StringTok{"violet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-6-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(MA2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-6-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#?Que concluimos?}
\DocumentationTok{\#\#Vamos a calcular el PACF de manera teorica }
\NormalTok{(}\AttributeTok{PACFMA=}\FunctionTok{ARMAacf}\NormalTok{( }\AttributeTok{ma=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{1.2}\NormalTok{), }\AttributeTok{ar=}\DecValTok{0}\NormalTok{,}\DecValTok{15}\NormalTok{, }\AttributeTok{pacf=}\NormalTok{T))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1]  0.03076923 -0.46292348  0.04461263 -0.27566723  0.05170474 -0.18101857
##  [7]  0.05318550 -0.12591880  0.05090694 -0.09137468  0.04654881 -0.06857228
## [13]  0.04131486 -0.05286052  0.03595283
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(PACFMA,}\AttributeTok{type=}\StringTok{"h"}\NormalTok{, }\AttributeTok{main=}\StringTok{"PACF teorico de un MA(2)"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{las=}\DecValTok{1}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{0}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{1}\NormalTok{, }\AttributeTok{col=}\StringTok{"violet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-6-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pacf}\NormalTok{(MA2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-6-5.pdf}

\#\#Ejercicio 2

Programamos la función recursiva para los coeficientes de correlación

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#phi es un vector con los coeficientes del modelo AR(p)}
\CommentTok{\#p es un vector con los acf para lag=1 y 2}
\NormalTok{coefs\_acf}\OtherTok{\textless{}{-}}\ControlFlowTok{function}\NormalTok{(phi,p,k)\{}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \FunctionTok{length}\NormalTok{(p)}\SpecialCharTok{:}\NormalTok{k}\SpecialCharTok{+}\DecValTok{1}\NormalTok{)\{}
\NormalTok{    p[i]}\OtherTok{=}\NormalTok{phi[}\DecValTok{1}\NormalTok{]}\SpecialCharTok{*}\NormalTok{p[i}\DecValTok{{-}1}\NormalTok{]}\SpecialCharTok{+}\NormalTok{phi[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{*}\NormalTok{p[i}\DecValTok{{-}2}\NormalTok{]}
\NormalTok{  \}}
  \FunctionTok{return}\NormalTok{(p)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Aplicamos:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{acf\_coefs\_ej2}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{8}\SpecialCharTok{/}\DecValTok{35}\NormalTok{,}\SpecialCharTok{{-}}\DecValTok{461}\SpecialCharTok{/}\DecValTok{700}\NormalTok{)}
\NormalTok{phi\_ej2}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.75}\NormalTok{)}
\NormalTok{acf\_coefs\_ej2}\OtherTok{\textless{}{-}}\FunctionTok{coefs\_acf}\NormalTok{(phi\_ej2,acf\_coefs\_ej2,}\DecValTok{10}\NormalTok{)}
\NormalTok{ACF\_2}\OtherTok{=}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{ACF=}\NormalTok{acf\_coefs\_ej2,}\AttributeTok{lag=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{10}\NormalTok{))}
\NormalTok{ACF\_2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            ACF lag
## 1   1.00000000   0
## 2  -0.22857143   1
## 3  -0.65857143   2
## 4   0.43485714   3
## 5   0.31998571   4
## 6  -0.45413714   5
## 7  -0.05833443   6
## 8   0.36393663   7
## 9  -0.10182383   8
## 10 -0.23222294   9
## 11  0.16925705  10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(ACF\_2,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{lag,}\AttributeTok{y=}\NormalTok{ACF))}\SpecialCharTok{+}\FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}\FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =} \DecValTok{0}\NormalTok{,}\AttributeTok{slope=}\DecValTok{0}\NormalTok{,}\AttributeTok{color=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-8-1.pdf}

Entonces:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Var\_Xt}\OtherTok{\textless{}{-}}\DecValTok{1}\SpecialCharTok{/}\NormalTok{(}\DecValTok{1}\SpecialCharTok{{-}}\FunctionTok{sum}\NormalTok{(phi\_ej2}\SpecialCharTok{*}\NormalTok{(acf\_coefs\_ej2[}\DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{])))}
\NormalTok{Var\_Xt}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2.411714
\end{verbatim}

Sabemos que en un modelo AR(p), solo los primeros p coeficientes del
PACF son distintos de 0, es decir, en este caso los primeros 2, para
lag=1 y 2. Aplicamos la función escrita anteriormente:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pacf\_ej2}\OtherTok{=}\FunctionTok{c}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)\{}
\NormalTok{  pacf\_ej2[i]}\OtherTok{\textless{}{-}}\FunctionTok{coefs\_pacf}\NormalTok{(acf\_coefs\_ej2,i}\DecValTok{{-}1}\NormalTok{)}
\NormalTok{\}}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{4}\SpecialCharTok{:}\DecValTok{11}\NormalTok{)\{}
\NormalTok{  pacf\_ej2[i]}\OtherTok{\textless{}{-}}\DecValTok{0}
\NormalTok{\}}
\NormalTok{PACF\_2}\OtherTok{=}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{PACF=}\NormalTok{pacf\_ej2,}\AttributeTok{lag=}\FunctionTok{c}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{10}\NormalTok{))}
\NormalTok{PACF\_2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          PACF lag
## 1   1.0000000   0
## 2  -0.2285714   1
## 3  -0.7500000   2
## 4   0.0000000   3
## 5   0.0000000   4
## 6   0.0000000   5
## 7   0.0000000   6
## 8   0.0000000   7
## 9   0.0000000   8
## 10  0.0000000   9
## 11  0.0000000  10
\end{verbatim}

Graficamos

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(PACF\_2,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{lag,}\AttributeTok{y=}\NormalTok{PACF))}\SpecialCharTok{+}\FunctionTok{geom\_point}\NormalTok{()}\SpecialCharTok{+}\FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =} \DecValTok{0}\NormalTok{,}\AttributeTok{slope=}\DecValTok{0}\NormalTok{,}\AttributeTok{color=}\StringTok{\textquotesingle{}red\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-11-1.pdf}

Simulamos

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\NormalTok{AR2}\OtherTok{=}\FunctionTok{arima.sim}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\AttributeTok{order=}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\AttributeTok{ar=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.75}\NormalTok{)),}\AttributeTok{n=}\DecValTok{500}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(AR2, }\AttributeTok{main=}\StringTok{"Simulación AR(2)"}\NormalTok{, }\AttributeTok{col=}\StringTok{"gold"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-12-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(}\AttributeTok{ACFAR=}\FunctionTok{ARMAacf}\NormalTok{(}\AttributeTok{ar=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.75}\NormalTok{), }\AttributeTok{ma=}\DecValTok{0}\NormalTok{,}\DecValTok{15}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           0           1           2           3           4           5 
##  1.00000000 -0.22857143 -0.65857143  0.43485714  0.31998571 -0.45413714 
##           6           7           8           9          10          11 
## -0.05833443  0.36393663 -0.10182383 -0.23222294  0.16925705  0.10646439 
##          12          13          14          15 
## -0.16952854 -0.01203687  0.13196115 -0.04375681
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(ACFAR,}\AttributeTok{type=}\StringTok{"h"}\NormalTok{, }\AttributeTok{main=}\StringTok{"PACF teorico de un MA(2)"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{2}\NormalTok{, }\AttributeTok{ylim=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\AttributeTok{las=}\DecValTok{1}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{0}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{1}\NormalTok{, }\AttributeTok{col=}\StringTok{"violet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-12-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{acf}\NormalTok{(AR2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-12-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#PACF}

\NormalTok{(}\AttributeTok{PACFAR=}\FunctionTok{ARMAacf}\NormalTok{(}\AttributeTok{ar=}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.4}\NormalTok{,}\SpecialCharTok{{-}}\FloatTok{0.75}\NormalTok{), }\AttributeTok{ma=}\DecValTok{0}\NormalTok{,}\DecValTok{15}\NormalTok{, }\AttributeTok{pacf=}\NormalTok{T))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] -2.285714e-01 -7.500000e-01  2.677540e-16  2.814762e-16  8.987415e-17
##  [6]  1.718906e-17  1.405709e-16  1.673463e-17  2.008155e-17  5.689773e-17
## [11]  4.685696e-17  8.869353e-17  4.351003e-17  6.693851e-17  2.342848e-17
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(PACFAR, }\AttributeTok{type=}\StringTok{"h"}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{3}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{h=}\DecValTok{0}\NormalTok{, }\AttributeTok{lwd=}\DecValTok{1}\NormalTok{, }\AttributeTok{col=}\StringTok{"violet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-12-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{pacf}\NormalTok{(AR2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Tarea_2_files/figure-latex/unnamed-chunk-12-5.pdf}

\end{document}
